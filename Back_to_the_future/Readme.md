# Back to the future [50]

先使用 `file` 指令看檔案的型態

```
KeyChecker.exe: PE32 executable (console)
```

可以用 x32dbg debug 檔案。

1. 首先要將時光機回到1985年，發現程式是用一個函式計算現在的年份，將40165A改成add 74A即可回到1985。
2. 接著要繞過 debug 檢查，方法是將 peb() 的第三個 bytes 從 01 改成 00。
3. 輸入密碼，一開始不知道輸入什麼就隨便輸入一串。之後那串密碼會和 0x20 做 or，和 7F (1985經過一些處理) 做 xor 結果必須要和 408008 開始的18 位數一樣，可以直接改輸入的內容和判斷式或是算出原本的密碼。

原本的密碼是 blog.30cm.tw/./././

`FLAG{PE\_!S_EASY}`
