# Safe R/W [200]

**python3 safe\_rw.py**

題目原本預期解是php的一個特性，這裡提供的是非預期的解法。

1. 有三個欄位可以輸入：目錄、檔案、內容，由於每次執行完目錄都會被刪掉，而且可寫的檔案只有meow(或許可以連外部的php檔)，所以這兩行更改沒有意義。
2. 內容的部分有兩個限制，一、字數不超過20，二、不含有 ’<’ 。字數方面可以用陣列方式繞過，但缺少 < 則不能執行任何 php 檔案，及成為死局。所以該題的重點是在檔案含有 <?php 的情況下繞過檢查。
3. 想到之前用 race condition 的方式接過一題程式語言 independent的題目。所以用python 寫了一個多線程request url 的程式，一個線程放 <?php%0asystem… 另一個則放不含 < 的字串，期望可以在通過檢查後蓋過原本的內容。
4. 用 system(“ls”) 慢慢搜目錄，最後在根目錄找到了FLAG。

`FLAG{welcome_t0_th3_PHP_W0rld}`
